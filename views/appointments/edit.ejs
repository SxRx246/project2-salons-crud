<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head.ejs') %>

  <body>

    <div class="site-wrap">

      <div class="site-mobile-menu">
        <div class="site-mobile-menu-header">
          <div class="site-mobile-menu-close mt-3">
            <span class="icon-close2 js-menu-toggle"></span>
          </div>
        </div>
        <div class="site-mobile-menu-body"></div>
      </div>


      <%- include('../partials/navbar.ejs') %>



        <div class="slide-one-item home-slider owl-carousel">

          <div class="site-blocks-cover inner-page-cover" style="background-image: url(/styles/images/hero_bg_2.jpg);"
            data-aos="fade" data-stellar-background-ratio="0.5">
            <div class="container">
              <div class="row align-items-center justify-content-center text-center">

                <div class="col-md-8" data-aos="fade-up" data-aos-delay="400">
                  <h2 class="text-white font-weight-light mb-2 display-1">Edit Appointment</h2>


                </div>
              </div>
            </div>
          </div>

        </div>



        <div class="site-section bg-light">
          <div class="container">
            <div class="row">
              <div class="col-md-7 mb-5">

                <form action="/appointments/<%= foundAppointment._id %>?_method=PUT" method="POST">
                  <h2 class="mb-4 site-section-heading">Edit Appointment</h2>

                  <input type="hidden" name="salon" value="<%= selectedSalonId || '' %>" />


                  <div class="row form-group">
                    <div class="col-md-6 mb-3 mb-md-0">
                      <label class="text-black" for="customerName">Customer Name</label>
                      <input type="text" id="customerName" name="customerName" class="form-control"
                        placeholder="Customer Name" value="<%= foundAppointment.customerName %>">

                    </div>
                  </div>

                  <div class="row form-group">
                    <div class="col-md-6 mb-3 mb-md-0">
                      <label class="text-black" for="date">Date</label>
                      <input type="text" id="date" name="date" class="form-control datepicker px-2"
                        placeholder="Date of visit"
                        value="<%= new Date(foundAppointment.date).toISOString().split('T')[0] %>">
                    </div>
                    <div class="col-md-6">
                      <label class="text-black" for="time">Time</label>
                      <input type="time" id="time" name="time" class="form-control" placeholder="Time"
                        value="<%= foundAppointment.time %>" required>
                    </div>
                  </div>

                  <div class="row form-group">
                    <div class="col-md-12">
                      <label class="text-black" for="services">Service You Want</label>
                      <select name="services" id="services" name="services" class="form-control" multiple required>
                        <% if (salonServices.length> 0) { %>
                          <% salonServices.forEach(service=> { %>
                            <option value="<%= service._id %>" <% if (foundAppointment.services.map(s=>
                              s._id.toString()).includes(service._id.toString())) { %>
                              selected
                              <% } %>>
                                <%= service.name %>
                            </option>
                            <% }) %>
                              <% } else { %>
                                <option disabled selected>No services available. Please select a salon.</option>
                                <% } %>

                      </select>
                    </div>
                  </div>
                  <div class="row form-group">
                    <div class="col-md-12">
                      <label class="text-black" for="staff">Staff You Want</label>
                      <select name="staff" id="staff" name="staff" class="form-control" required>
                        <% if (salonStaffs.length> 0) { %>
                          <% salonStaffs.forEach(staff=> { %>
                            <option value="<%= staff._id %>" <% if (foundAppointment.staff &&
                              staff._id.toString()===foundAppointment.staff._id.toString()) { %>
                              selected
                              <% } %>>
                                <%= staff.name %> - <%= staff.specialty %>
                            </option>
                            <% }) %>
                              <% } else { %>
                                <option disabled selected>No staff available. Please select a salon.</option>
                                <% } %>
                      </select>
                    </div>
                  </div>

                  <div class="row form-group">
                    <div class="col-md-12">
                      <input type="submit" value="Update Appointment" class="btn btn-primary py-2 px-4 text-white">
                    </div>
                  </div>


                </form>
              </div>
            </div>
          </div>
        </div>


        <div class="site-section">
          <div class="container">
            <div class="row text-center">
              <div class="col-md-12">
                <h2 class="mb-4 text-black">We want you to look fabulous</h2>
                <p class="mb-0"><a href="/salons/<%= selectedSalonId %>"
                    class="btn btn-primary py-3 px-5 text-white">Visit Our Salon Now</a></p>
              </div>
            </div>
          </div>
        </div>
    </div>

    <%- include('../partials/footer.ejs') %>
      <%- include('../partials/scripts.ejs') %>

  </body>

</html>